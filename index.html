<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="–•—Ä–∞–º –î—É—à–∏ - –î—É—Ö–æ–≤–Ω–æ–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ" />
    <title>–•—Ä–∞–º –î—É—à–∏</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            background: #000;
            color: #fff;
            overflow-x: hidden;
        }
        
        .game-container {
            width: 100vw;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #000;
            padding: 20px;
        }
        
        .game-content {
            width: 800px;
            max-width: 100%;
            height: 100vh;
            background: #fff;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
        }
        
        .background-image {
            width: 100%;
            height: calc(100vh - 200px);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
            text-align: center;
            padding: 40px;
        }
        
        .scene-title {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 1.8rem;
            font-weight: 300;
            color: #fff;
            letter-spacing: 2px;
            margin: 0;
            text-align: center;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.8);
            z-index: 4;
            animation: fadeInDown 0.8s ease-out;
        }
        
        .narrator-section {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 0 40px 20px 40px;
            background: transparent;
        }
        
        .narrator-paragraph {
            font-size: 1rem;
            color: #fff;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
            font-style: italic;
            background: rgba(0, 0, 0, 0.6);
            padding: 12px 16px;
            border-radius: 12px;
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            max-width: 80%;
            margin: 0 auto;
            word-wrap: break-word;
        }
        
        .character-container {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1;
            pointer-events: none;
        }
        
        .character-image {
            max-width: 360px;
            max-height: 450px;
            border-radius: 10px;
            animation: float 3s ease-in-out infinite;
            opacity: 0.9;
        }
        
        .scene-content {
            padding: 0;
            background: #fff;
            text-align: center;
            animation: slideInUp 0.8s ease-out;
            color: #333;
            width: 100%;
            flex-shrink: 0;
        }
        
        .choice-container {
            background: #fff;
            padding: 30px 40px;
            border-radius: 15px;
            border: 1px solid #e9ecef;
            width: 100%;
            margin: 0;
        }
        
        .choice-question {
            font-size: 1.2rem;
            color: #333;
            margin-bottom: 20px;
            font-weight: 500;
        }
        
        .choice-buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
            align-items: center;
        }
        
        .choice-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s ease;
            width: 100%;
            max-width: 600px;
            box-shadow: 0 3px 10px rgba(102, 126, 234, 0.3);
        }
        
        .choice-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        
        .next-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 30px 0 15px 0;
            width: 100%;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        
        .next-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }
        
        .completion-screen {
            text-align: center;
            padding: 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 20px;
            margin: 20px;
        }
        
        .completion-title {
            font-size: 2.5rem;
            margin-bottom: 20px;
            font-weight: 300;
        }
        
        .completion-text {
            font-size: 1.2rem;
            margin-bottom: 30px;
            line-height: 1.6;
        }
        
        .choices-summary {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
        }
        
        .choice-item {
            margin: 10px 0;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
        }
        
        .restart-button {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            margin-top: 20px;
        }
        
        .restart-button:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
        }
        
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }
        
        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes float {
            0%, 100% {
                transform: translateX(-50%) translateY(0px);
            }
            50% {
                transform: translateX(-50%) translateY(-10px);
            }
        }
        
        @media (max-width: 768px) {
            .game-content {
                width: 95%;
                height: 100vh;
            }
            
            .background-image {
                height: calc(100vh - 150px);
            }
            
            .scene-title {
                font-size: 1.5rem;
            }
            
            .narrator-paragraph {
                font-size: 0.9rem;
                padding: 10px 12px;
            }
            
            .character-image {
                max-width: 300px;
                max-height: 360px;
            }
            
            .choice-container {
                padding: 20px;
            }
            
            .choice-button {
                padding: 12px 15px;
                font-size: 0.9rem;
            }
        }
        
        @media (max-width: 480px) {
            .game-content {
                width: 100%;
                height: 100vh;
                border-radius: 0;
            }
            
            .background-image {
                height: calc(100vh - 120px);
            }
            
            .scene-title {
                font-size: 1.3rem;
            }
            
            .narrator-paragraph {
                font-size: 0.8rem;
                padding: 8px 10px;
            }
            
            .character-image {
                max-width: 240px;
                max-height: 300px;
            }
            
            .choice-container {
                padding: 15px;
            }
            
            .choice-button {
                padding: 10px 12px;
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="game-content">
            <div class="background-image" id="backgroundImage">
                <h1 class="scene-title" id="sceneTitle">–•—Ä–∞–º –î—É—à–∏</h1>
                <div class="narrator-section">
                    <p class="narrator-paragraph" id="narratorText">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –•—Ä–∞–º –î—É—à–∏</p>
                </div>
                <div class="character-container" id="characterContainer" style="display: none;">
                    <img class="character-image" id="characterImage" alt="Character">
                </div>
            </div>
            <div class="scene-content" id="sceneContent">
                <div class="choice-container">
                    <div class="choice-question" id="choiceQuestion">–ì–æ—Ç–æ–≤—ã –Ω–∞—á–∞—Ç—å –≤–∞—à–µ –¥—É—Ö–æ–≤–Ω–æ–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ?</div>
                    <div class="choice-buttons" id="choiceButtons">
                        <button class="choice-button" onclick="startGame()">–ù–∞—á–∞—Ç—å –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Game data with gradient backgrounds instead of images
        const gameData = [
            {
                id: 'scene_01',
                title: '–ü—Ä–∏—Ä–æ–¥–Ω–æ–µ –ú–µ—Å—Ç–æ',
                steps: [
                    {
                        id: 'scene_01_step_1',
                        title: '–ü—Ä–∏—Ä–æ–¥–Ω–æ–µ –ú–µ—Å—Ç–æ',
                        background: 'linear-gradient(135deg, #4CAF50 0%, #8BC34A 100%)',
                        narrator: '–í—ã –æ–∫–∞–∑—ã–≤–∞–µ—Ç–µ—Å—å –≤ –∫–∞–∫–æ–º-—Ç–æ –æ—á–µ–Ω—å –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–º, –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –∏ –ø—Ä–∏—è—Ç–Ω–æ–º –¥–ª—è –≤–∞—Å –ø—Ä–∏—Ä–æ–¥–Ω–æ–º –º–µ—Å—Ç–µ. –ú–æ–∂–µ—Ç –±—ã—Ç—å, —ç—Ç–æ –∫–∞–∫–æ–π-—Ç–æ –ª—É–≥, –∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –ª–µ—Å –∏–ª–∏ –±–µ—Ä–µ–≥ –º–æ—Ä—è –∏–ª–∏ —Ä–µ–∫–∏. –õ—é–±–æ–π –æ–±—Ä–∞–∑ –ø–æ–¥–æ–π–¥–µ—Ç.'
                    },
                    {
                        id: 'scene_01_step_2',
                        title: '–ü—Ä–∏—Ä–æ–¥–Ω–æ–µ –ú–µ—Å—Ç–æ',
                        background: 'linear-gradient(135deg, #4CAF50 0%, #8BC34A 100%)',
                        narrator: '–û–≥–ª—è–¥–∏—Ç–µ—Å—å –ø–æ —Å—Ç–æ—Ä–æ–Ω–∞–º, –ø–æ–æ—â—É—â–∞–π—Ç–µ, –∫–∞–∫ –≤—ã —Å–µ–±—è –∑–¥–µ—Å—å —á—É–≤—Å—Ç–≤—É–µ—Ç–µ?',
                        choice: {
                            question: '–ö–∞–∫ –≤—ã —Å–µ–±—è –∑–¥–µ—Å—å —á—É–≤—Å—Ç–≤—É–µ—Ç–µ?',
                            options: [
                                { id: 'A', text: '–£—é—Ç–Ω–æ –∏ –∑–∞—â–∏—â–µ–Ω–Ω–æ.' },
                                { id: 'B', text: '–°–ø–æ–∫–æ–π–Ω–æ –∏ —É–º–∏—Ä–æ—Ç–≤–æ—Ä–µ–Ω–Ω–æ.' },
                                { id: 'C', text: '–†–∞–¥–æ—Å—Ç–Ω–æ –∏ –≤–æ–æ–¥—É—à–µ–≤–ª–µ–Ω–Ω–æ.' }
                            ]
                        }
                    }
                ]
            },
            {
                id: 'scene_01b',
                title: '–¢—Ä–æ–ø–∏–Ω–∫–∞',
                steps: [
                    {
                        id: 'scene_01b_step_1',
                        title: '–¢—Ä–æ–ø–∏–Ω–∫–∞',
                        background: 'linear-gradient(135deg, #2196F3 0%, #03A9F4 100%)',
                        narrator: '–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –ø—Ä—è–º–æ –ø–æ–¥ –≤–∞—à–∏–º–∏ –Ω–æ–≥–∞–º–∏ –µ—Å—Ç—å —Ç—Ä–æ–ø–∏–Ω–∫–∞! –í—ã —É–∂–µ —Å—Ç–æ–∏—Ç–µ –Ω–∞ –Ω–µ–π. –ù–æ —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ç—Ä–æ–ø–∏–Ω–∫–∞. –≠—Ç–æ –ø—É—Ç—å, –∫–æ—Ç–æ—Ä—ã–π –≤–µ–¥–µ—Ç –≤–∞—Å –∫ –æ—á–µ–Ω—å –≤–∞–∂–Ω–æ–º—É —Å–≤—è—â–µ–Ω–Ω–æ–º—É –¥–ª—è –≤–∞—Å –º–µ—Å—Ç—É - –•–†–ê–ú–£ –í–ê–®–ï–ô –î–£–®–ò!'
                    },
                    {
                        id: 'scene_01b_step_2',
                        title: '–¢—Ä–æ–ø–∏–Ω–∫–∞',
                        background: 'linear-gradient(135deg, #2196F3 0%, #03A9F4 100%)',
                        narrator: '–≠—Ç–æ –æ—á–µ–Ω—å –≤–∞–∂–Ω–∞—è –≤—Å—Ç—Ä–µ—á–∞, –∫–∞–∫ –¥–ª—è –≤–∞—Å, —Ç–∞–∫ –∏ –¥–ª—è —Å–∞–º–æ–≥–æ —Ö—Ä–∞–º–∞. –í—ã –Ω–∞—á–∏–Ω–∞–µ—Ç–µ –¥–≤–∏–≥–∞—Ç—å—Å—è –ø–æ —ç—Ç–æ–π —Ç—Ä–æ–ø–∏–Ω–∫–µ —à–∞–≥ –∑–∞ —à–∞–≥–æ–º.'
                    }
                ]
            },
            {
                id: 'scene_02',
                title: '–•—Ä–∞–º –°–Ω–∞—Ä—É–∂–∏',
                steps: [
                    {
                        id: 'scene_02_step_1',
                        title: '–•—Ä–∞–º –°–Ω–∞—Ä—É–∂–∏',
                        background: 'linear-gradient(135deg, #FF9800 0%, #FFC107 100%)',
                        narrator: '–í—ã –ø–æ–¥—Ö–æ–¥–∏—Ç–µ –∫ –•—Ä–∞–º—É –î—É—à–∏. –≠—Ç–æ –æ—á–µ–Ω—å –∫—Ä–∞—Å–∏–≤–æ–µ –∏ –æ—Å–æ–±–µ–Ω–Ω–æ–µ –º–µ—Å—Ç–æ. –•—Ä–∞–º –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ –∂–∏–≤–æ–µ —Å—É—â–µ—Å—Ç–≤–æ - —É –Ω–µ–≥–æ –µ—Å—Ç—å —Å–≤–æ–∏ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏, —Å–≤–æ—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ—Å—Ç—å.'
                    },
                    {
                        id: 'scene_02_step_2',
                        title: '–•—Ä–∞–º –°–Ω–∞—Ä—É–∂–∏',
                        background: 'linear-gradient(135deg, #FF9800 0%, #FFC107 100%)',
                        narrator: '–í—ã –≤–∏–¥–∏—Ç–µ, —á—Ç–æ —É —Ö—Ä–∞–º–∞ –µ—Å—Ç—å –Ω–µ–±–æ–ª—å—à–∏–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ - –º–æ–∂–µ—Ç –±—ã—Ç—å, –≥–¥–µ-—Ç–æ —Ä–∞—Å—Ç–µ—Ç –º–æ—Ö, –∏–ª–∏ –µ—Å—Ç—å –Ω–µ–±–æ–ª—å—à–∞—è —Ç—Ä–µ—â–∏–Ω–∞. –≠—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ —Ö—Ä–∞–º –∂–∏–≤–æ–π, —á—Ç–æ —É –Ω–µ–≥–æ –µ—Å—Ç—å —Å–≤–æ—è –∏—Å—Ç–æ—Ä–∏—è.'
                    },
                    {
                        id: 'scene_02_step_3',
                        title: '–•—Ä–∞–º –°–Ω–∞—Ä—É–∂–∏',
                        background: 'linear-gradient(135deg, #FF9800 0%, #FFC107 100%)',
                        narrator: '–í—ã —á—É–≤—Å—Ç–≤—É–µ—Ç–µ, —á—Ç–æ —ç—Ç–æ—Ç —Ö—Ä–∞–º - —ç—Ç–æ –º–µ—Ç–∞—Ñ–æ—Ä–∞ –≤–∞—à–µ–≥–æ —Ç–µ–ª–∞. –û–Ω –∫—Ä–∞—Å–∏–≤—ã–π, –æ—Å–æ–±–µ–Ω–Ω—ã–π, –Ω–æ —É –Ω–µ–≥–æ –µ—Å—Ç—å —Å–≤–æ–∏ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏.'
                    }
                ]
            },
            {
                id: 'scene_02b',
                title: '–î–≤–µ—Ä—å –•—Ä–∞–º–∞',
                steps: [
                    {
                        id: 'scene_02b_step_1',
                        title: '–î–≤–µ—Ä—å –•—Ä–∞–º–∞',
                        background: 'linear-gradient(135deg, #9C27B0 0%, #E91E63 100%)',
                        narrator: '–í—ã –ø–æ–¥—Ö–æ–¥–∏—Ç–µ –∫ –¥–≤–µ—Ä–∏ –•—Ä–∞–º–∞ –î—É—à–∏. –î–≤–µ—Ä—å –≤—ã–≥–ª—è–¥–∏—Ç –æ—á–µ–Ω—å –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ –∏ –ø—Ä–∏–≥–ª–∞—à–∞—é—â–µ. –í—ã —á—É–≤—Å—Ç–≤—É–µ—Ç–µ, —á—Ç–æ –∑–∞ —ç—Ç–æ–π –¥–≤–µ—Ä—å—é –≤–∞—Å –∂–¥–µ—Ç —á—Ç–æ-—Ç–æ –æ—á–µ–Ω—å –≤–∞–∂–Ω–æ–µ.'
                    },
                    {
                        id: 'scene_02b_step_2',
                        title: '–î–≤–µ—Ä—å –•—Ä–∞–º–∞',
                        background: 'linear-gradient(135deg, #9C27B0 0%, #E91E63 100%)',
                        narrator: '–í—ã –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç–µ –¥–≤–µ—Ä—å –∏ –≤—Ö–æ–¥–∏—Ç–µ –≤–Ω—É—Ç—Ä—å —Ö—Ä–∞–º–∞. –í–Ω—É—Ç—Ä–∏ –≤–∞—Å –∂–¥–µ—Ç —É–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ.'
                    }
                ]
            },
            {
                id: 'scene_03',
                title: '–í–Ω—É—Ç—Ä–∏ –•—Ä–∞–º–∞',
                steps: [
                    {
                        id: 'scene_03_step_1',
                        title: '–í–Ω—É—Ç—Ä–∏ –•—Ä–∞–º–∞',
                        background: 'linear-gradient(135deg, #607D8B 0%, #455A64 100%)',
                        character: 'üë§',
                        narrator: '–í—ã –≤—Ö–æ–¥–∏—Ç–µ –≤–Ω—É—Ç—Ä—å –•—Ä–∞–º–∞ –î—É—à–∏. –≠—Ç–æ –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ—Ä–Ω–æ–µ –∏ —Å–≤–µ—Ç–ª–æ–µ –º–µ—Å—Ç–æ. –í–Ω—É—Ç—Ä–∏ —Ö—Ä–∞–º–∞ —Ü–∞—Ä–∏—Ç –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞ –ø–æ–∫–æ—è –∏ –ø—Ä–∏–Ω—è—Ç–∏—è.'
                    },
                    {
                        id: 'scene_03_step_2',
                        title: '–í–Ω—É—Ç—Ä–∏ –•—Ä–∞–º–∞',
                        background: 'linear-gradient(135deg, #607D8B 0%, #455A64 100%)',
                        character: 'üë§',
                        narrator: '–í—ã –≤–∏–¥–∏—Ç–µ, —á—Ç–æ –≤ —Ö—Ä–∞–º–µ –µ—Å—Ç—å –Ω–µ–±–æ–ª—å—à–∏–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ - –º–æ–∂–µ—Ç –±—ã—Ç—å, —Ç—Ä–µ—â–∏–Ω–∞ –≤ —Å—Ç–µ–Ω–µ –∏–ª–∏ –∑–∞—Ç—É–º–∞–Ω–µ–Ω–Ω–æ–µ –æ–∫–Ω–æ. –≠—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ —Ö—Ä–∞–º –∂–∏–≤–æ–π, —á—Ç–æ –≤ –Ω–µ–º –µ—Å—Ç—å –∂–∏–∑–Ω—å.'
                    },
                    {
                        id: 'scene_03_step_3',
                        title: '–í–Ω—É—Ç—Ä–∏ –•—Ä–∞–º–∞',
                        background: 'linear-gradient(135deg, #607D8B 0%, #455A64 100%)',
                        character: 'üë§',
                        narrator: '–í—ã –ø–æ–Ω–∏–º–∞–µ—Ç–µ, —á—Ç–æ —ç—Ç–æ—Ç —Ö—Ä–∞–º - —ç—Ç–æ –º–µ—Ç–∞—Ñ–æ—Ä–∞ –≤–∞—à–µ–≥–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –º–∏—Ä–∞. –û–Ω –∫—Ä–∞—Å–∏–≤—ã–π –∏ –æ—Å–æ–±–µ–Ω–Ω—ã–π, –Ω–æ —É –Ω–µ–≥–æ –µ—Å—Ç—å —Å–≤–æ–∏ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏.'
                    },
                    {
                        id: 'scene_03_step_4',
                        title: '–í–Ω—É—Ç—Ä–∏ –•—Ä–∞–º–∞',
                        background: 'linear-gradient(135deg, #607D8B 0%, #455A64 100%)',
                        character: 'üë§',
                        narrator: '–í–Ω–µ–∑–∞–ø–Ω–æ –≤—ã –≤–∏–¥–∏—Ç–µ, –∫–∞–∫ –∏–∑ –Ω–∏–æ—Ç–∫—É–¥–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤–∞—à–∞ –î—É—à–∞. –û–Ω–∞ –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ —Å–≤–µ—Ç—è—â–∞—è—Å—è, –ø–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω–∞—è –∂–µ–Ω—Å–∫–∞—è —Ñ–∏–≥—É—Ä–∞ –±–µ–∑ –ª–∏—Ü–∞.'
                    }
                ]
            },
            {
                id: 'scene_04',
                title: '–ò—Å—Ü–µ–ª–µ–Ω–∏–µ',
                steps: [
                    {
                        id: 'scene_04_step_1',
                        title: '–ò—Å—Ü–µ–ª–µ–Ω–∏–µ',
                        background: 'linear-gradient(135deg, #00BCD4 0%, #0097A7 100%)',
                        character: '‚ú®',
                        narrator: '–î—É—à–∞ –≥–æ–≤–æ—Ä–∏—Ç: "–¢—ã –¥–∞–≤–Ω–æ –∂–¥–∞–ª–∞ —ç—Ç–æ–π –≤—Å—Ç—Ä–µ—á–∏. –Ø —Ç–æ–∂–µ. –ß—Ç–æ–±—ã —Ç—ã —É–¥–µ–ª–∏–ª–∞ –º–Ω–µ –≤–Ω–∏–º–∞–Ω–∏–µ, –ø–æ–¥–∞—Ä–∏–ª–∞ —Å–≤–æ—é –ª—é–±–æ–≤—å –∏ –ø–æ–º–æ–≥–ª–∞ –∏—Å—Ü–µ–ª–∏—Ç—å —á—Ç–æ-—Ç–æ –≤–∞–∂–Ω–æ–µ. –ß—Ç–æ–±—ã –Ω–∞–º —Å—Ç–∞–ª–æ –µ—â–µ –ª—É—á—à–µ, –µ—â–µ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–µ–µ."'
                    },
                    {
                        id: 'scene_04_step_2',
                        title: '–ò—Å—Ü–µ–ª–µ–Ω–∏–µ',
                        background: 'linear-gradient(135deg, #00BCD4 0%, #0097A7 100%)',
                        character: '‚ú®',
                        narrator: '–í–Ω–µ–∑–∞–ø–Ω–æ –≤ —Ö—Ä–∞–º–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –∏—Å—Ü–µ–ª–µ–Ω–∏–µ. –ü–æ —Å—Ç–µ–Ω–∞–º —Ç–µ—á–µ—Ç –ø–æ—Ç–æ–∫ –∏—Å—Ü–µ–ª—è—é—â–µ–≥–æ —Å–≤–µ—Ç–∞ - –∑–æ–ª–æ—Ç–æ–≥–æ, —Ñ–∏–æ–ª–µ—Ç–æ–≤–æ–≥–æ –∏–ª–∏ —Ä–æ–∑–æ–≤–æ–≥–æ. –°–≤–µ—Ç –∑–∞–ø–æ–ª–Ω—è–µ—Ç –≤—Å–µ —Ç—Ä–µ—â–∏–Ω—ã –∏ –∑–∞—Ç—É–º–∞–Ω–µ–Ω–Ω—ã–µ –º–µ—Å—Ç–∞.'
                    },
                    {
                        id: 'scene_04_step_3',
                        title: '–ò—Å—Ü–µ–ª–µ–Ω–∏–µ',
                        background: 'linear-gradient(135deg, #00BCD4 0%, #0097A7 100%)',
                        character: '‚ú®',
                        narrator: '–í—ã —á—É–≤—Å—Ç–≤—É–µ—Ç–µ, –∫–∞–∫ –∏—Å—Ü–µ–ª—è–µ—Ç—Å—è –≤–∞—à –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –º–∏—Ä. –í—Å–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –∏ —Ç—Ä–µ—â–∏–Ω—ã –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è —Å–≤–µ—Ç–æ–º –ª—é–±–≤–∏ –∏ –ø—Ä–∏–Ω—è—Ç–∏—è. –í—ã —Å—Ç–∞–Ω–æ–≤–∏—Ç–µ—Å—å —Ü–µ–ª–æ—Å—Ç–Ω—ã–º–∏.'
                    }
                ]
            },
            {
                id: 'scene_05',
                title: '–ï–¥–∏–Ω—Å—Ç–≤–æ',
                steps: [
                    {
                        id: 'scene_05_step_1',
                        title: '–ï–¥–∏–Ω—Å—Ç–≤–æ',
                        background: 'linear-gradient(135deg, #795548 0%, #5D4037 100%)',
                        character: 'üí´',
                        narrator: '–í—ã –∏ –≤–∞—à–∞ –î—É—à–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç–µ—Å—å –µ–¥–∏–Ω—ã–º —Ü–µ–ª—ã–º. –í—ã —á—É–≤—Å—Ç–≤—É–µ—Ç–µ, –∫–∞–∫ –≤–∞—à–µ —Ç–µ–ª–æ –∏ –¥—É—à–∞ —Å–ª–∏–≤–∞—é—Ç—Å—è –≤ –æ–¥–Ω–æ –≥–∞—Ä–º–æ–Ω–∏—á–Ω–æ–µ —Å—É—â–µ—Å—Ç–≤–æ.'
                    },
                    {
                        id: 'scene_05_step_2',
                        title: '–ï–¥–∏–Ω—Å—Ç–≤–æ',
                        background: 'linear-gradient(135deg, #795548 0%, #5D4037 100%)',
                        character: 'üí´',
                        narrator: '–í—ã –ø–æ–Ω–∏–º–∞–µ—Ç–µ, —á—Ç–æ —Ç–µ–ø–µ—Ä—å –≤—ã - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ç–µ–ª–æ –∏ –¥—É—à–∞ –æ—Ç–¥–µ–ª—å–Ω–æ, –∞ –µ–¥–∏–Ω–æ–µ —Ü–µ–ª–æ–µ. –í—ã —á—É–≤—Å—Ç–≤—É–µ—Ç–µ —Å–µ–±—è —Ü–µ–ª–æ—Å—Ç–Ω—ã–º–∏, –≥–∞—Ä–º–æ–Ω–∏—á–Ω—ã–º–∏ –∏ —Å—á–∞—Å—Ç–ª–∏–≤—ã–º–∏.'
                    }
                ]
            }
        ];

        let currentSceneIndex = 0;
        let currentStepIndex = 0;
        let choices = {};

        function getCurrentStep() {
            const currentScene = gameData[currentSceneIndex];
            return currentScene?.steps[currentStepIndex];
        }

        function isLastStep() {
            const currentScene = gameData[currentSceneIndex];
            return currentStepIndex === (currentScene?.steps.length || 1) - 1;
        }

        function updateDisplay() {
            const currentStep = getCurrentStep();
            if (!currentStep) return;

            // Update background
            console.log('Setting background to:', currentStep.background);
            backgroundImage.style.background = currentStep.background;
            backgroundImage.style.backgroundSize = 'cover';
            backgroundImage.style.backgroundPosition = 'center';
            
            // Update title
            sceneTitle.textContent = currentStep.title;
            
            // Update narrator text
            narratorText.textContent = currentStep.narrator;
            
            // Update character
            if (currentStep.character) {
                characterContainer.style.display = 'block';
                characterImage.src = 'data:image/svg+xml;base64,' + btoa(`
                    <svg width="100" height="100" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="50" cy="50" r="40" fill="rgba(255,255,255,0.8)" stroke="rgba(255,255,255,0.5)" stroke-width="2"/>
                        <text x="50" y="60" text-anchor="middle" font-size="40" fill="#333">${currentStep.character}</text>
                    </svg>
                `);
            } else {
                characterContainer.style.display = 'none';
            }
            
            // Update choices
            if (currentStep.choice) {
                choiceQuestion.textContent = currentStep.choice.question;
                choiceButtons.innerHTML = currentStep.choice.options.map(option => 
                    `<button class="choice-button" onclick="handleChoice('${option.id}')">${option.text}</button>`
                ).join('');
            } else if (isLastStep()) {
                // Show next scene button
                choiceQuestion.textContent = '–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ';
                choiceButtons.innerHTML = '<button class="choice-button" onclick="nextScene()">–î–∞–ª—å—à–µ</button>';
            } else {
                // Show next step button
                choiceQuestion.textContent = '–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å';
                choiceButtons.innerHTML = '<button class="choice-button" onclick="nextStep()">–î–∞–ª—å—à–µ</button>';
            }
        }

        function handleChoice(choiceId) {
            const currentStep = getCurrentStep();
            if (currentStep?.choice) {
                choices[currentStep.id] = choiceId;
            }
            nextStep();
        }

        function nextStep() {
            if (isLastStep()) {
                nextScene();
            } else {
                currentStepIndex++;
                updateDisplay();
            }
        }

        function nextScene() {
            if (currentSceneIndex < gameData.length - 1) {
                currentSceneIndex++;
                currentStepIndex = 0;
                updateDisplay();
            } else {
                showCompletion();
            }
        }

        function showCompletion() {
            const completionHTML = `
                <div class="completion-screen">
                    <h1 class="completion-title">–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –ó–∞–≤–µ—Ä—à–µ–Ω–æ!</h1>
                    <p class="completion-text">
                        –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—à–ª–∏ —á–µ—Ä–µ–∑ –•—Ä–∞–º –î—É—à–∏ –∏ –æ–±—Ä–µ–ª–∏ –≥–∞—Ä–º–æ–Ω–∏—é –º–µ–∂–¥—É —Ç–µ–ª–æ–º –∏ –¥—É—à–æ–π.
                    </p>
                    <div class="choices-summary">
                        <h3>–í–∞—à–∏ –≤—ã–±–æ—Ä—ã:</h3>
                        ${Object.entries(choices).map(([stepId, choiceId]) => {
                            const scene = gameData.find(s => s.steps.some(step => step.id === stepId));
                            const step = scene?.steps.find(s => s.id === stepId);
                            const choice = step?.choice?.options.find(opt => opt.id === choiceId);
                            return `<div class="choice-item"><strong>${scene?.title}:</strong> ${choice?.text}</div>`;
                        }).join('')}
                    </div>
                    <button class="restart-button" onclick="restartGame()">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
                </div>
            `;
            
            document.querySelector('.game-content').innerHTML = completionHTML;
        }

        function restartGame() {
            currentSceneIndex = 0;
            currentStepIndex = 0;
            choices = {};
            
            // Recreate the game structure
            document.querySelector('.game-content').innerHTML = `
                <div class="background-image" id="backgroundImage">
                    <h1 class="scene-title" id="sceneTitle">–•—Ä–∞–º –î—É—à–∏</h1>
                    <div class="narrator-section">
                        <p class="narrator-paragraph" id="narratorText">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –•—Ä–∞–º –î—É—à–∏</p>
                    </div>
                    <div class="character-container" id="characterContainer" style="display: none;">
                        <img class="character-image" id="characterImage" alt="Character">
                    </div>
                </div>
                <div class="scene-content" id="sceneContent">
                    <div class="choice-container">
                        <div class="choice-question" id="choiceQuestion">–ì–æ—Ç–æ–≤—ã –Ω–∞—á–∞—Ç—å –≤–∞—à–µ –¥—É—Ö–æ–≤–Ω–æ–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ?</div>
                        <div class="choice-buttons" id="choiceButtons">
                            <button class="choice-button" onclick="startGame()">–ù–∞—á–∞—Ç—å –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ</button>
                        </div>
                    </div>
                </div>
            `;
            
            // Reassign references
            backgroundImage = document.getElementById('backgroundImage');
            sceneTitle = document.getElementById('sceneTitle');
            narratorText = document.getElementById('narratorText');
            characterContainer = document.getElementById('characterContainer');
            characterImage = document.getElementById('characterImage');
            choiceQuestion = document.getElementById('choiceQuestion');
            choiceButtons = document.getElementById('choiceButtons');
        }

        function startGame() {
            currentSceneIndex = 0;
            currentStepIndex = 0;
            updateDisplay();
        }

        // Initialize
        let backgroundImage = document.getElementById('backgroundImage');
        let sceneTitle = document.getElementById('sceneTitle');
        let narratorText = document.getElementById('narratorText');
        let characterContainer = document.getElementById('characterContainer');
        let characterImage = document.getElementById('characterImage');
        let choiceQuestion = document.getElementById('choiceQuestion');
        let choiceButtons = document.getElementById('choiceButtons');
    </script>
</body>
</html>
